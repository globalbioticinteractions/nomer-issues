[{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1018938397","html_url":"https://github.com/globalbioticinteractions/nomer/issues/73#issuecomment-1018938397","issue_url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/73","id":1018938397,"node_id":"IC_kwDOBvmSqc48u8Qd","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T23:21:18Z","updated_at":"2022-01-21T23:21:18Z","body":"See also https://doi.org/10.5281/zenodo.4299787 ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1018938397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1019006421","html_url":"https://github.com/globalbioticinteractions/nomer/issues/73#issuecomment-1019006421","issue_url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/73","id":1019006421,"node_id":"IC_kwDOBvmSqc48vM3V","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-22T01:27:37Z","updated_at":"2022-01-22T01:27:37Z","body":"Using existing functionality, you can do:\r\n\r\n1. build nomer compatible taxon graph using https://doi.org/10.5281/zenodo.4299787  using miller (https://github.com/johnkerl/miller) and Nomer\r\n\r\n```\r\n$ curl \"https://zenodo.org/record/4299787/files/be_species_info.csv\"\\\r\n | mlr --icsv --otsvlite cut -f speciesKey,scientificName\\\r\n | tail -n+2 \\\r\n | sed \"s/^/GBIF:/g\"\\\r\n | nomer append gbif\\\r\n> taxonMatches.tsv\r\n# print first two lines\r\n$ head -n2 taxonMatches.tsv \r\nGBIF:1000106\tMethanobacterium alcaliphilum Worakit et al., 1986\tSAME_AS\tGBIF:1000106\tMethanobacterium alcaliphilum\tspecies\t\tArchaea | Methanobacteriota | Methanobacteria | Methanobacteriales | Methanobacteriaceae | Methanobacterium | Methanobacterium alcaliphilum\tGBIF:2 | GBIF:10895798 | GBIF:293 | GBIF:1192 | GBIF:3801 | GBIF:1000091 | GBIF:1000106\tkingdom | phylum | class | order | family | genus | species\thttp://www.gbif.org/species/1000106\t\r\nGBIF:1000484\tFilinia terminalis (Plate, 1886)\tSAME_AS\tGBIF:1000484\tFilinia terminalis\tspecies\t\tAnimalia | Rotifera | Eurotatoria | Flosculariaceae | Trochosphaeridae | Filinia | Filinia terminalis\tGBIF:1 | GBIF:91 | GBIF:307 | GBIF:1005 | GBIF:7517 | GBIF:1000456 | GBIF:1000484\tkingdom | phylum | class | order | family | genus | species\thttp://www.gbif.org/species/1000484\t\r\n```\r\n\r\n2. generate Nomer name graph format with taxonMap.tsv containing edges and taxonCache.tsv resolved nodes:\r\n\r\n```\r\n$ cat taxonMatches.tsv | grep -v NONE | cut -f1,2,4,5 | tee taxonMap.tsv | head -n2\r\nGBIF:1000106\tMethanobacterium alcaliphilum Worakit et al., 1986\tGBIF:1000106\tMethanobacterium alcaliphilum\r\nGBIF:1000484\tFilinia terminalis (Plate, 1886)\tGBIF:1000484\tFilinia terminalis\r\n\r\n$ cat taxonMatches.tsv | cut -f4- | tee taxonCache.tsv | head -n2\r\nGBIF:1000106\tMethanobacterium alcaliphilum\tspecies\t\tArchaea | Methanobacteriota | Methanobacteria | Methanobacteriales | Methanobacteriaceae | Methanobacterium | Methanobacterium alcaliphilum\tGBIF:2 | GBIF:10895798 | GBIF:293 | GBIF:1192 | GBIF:3801 | GBIF:1000091 | GBIF:1000106\tkingdom | phylum | class | order | family | genus | species\thttp://www.gbif.org/species/1000106\t\r\nGBIF:1000484\tFilinia terminalis\tspecies\t\tAnimalia | Rotifera | Eurotatoria | Flosculariaceae | Trochosphaeridae | Filinia | Filinia terminalis\tGBIF:1 | GBIF:91 | GBIF:307 | GBIF:1005 | GBIF:7517 | GBIF:1000456 | GBIF:1000484\tkingdom | phylum | class | order | family | genus | species\thttp://www.gbif.org/species/1000484\t\r\n```\r\n\r\n3. get some interaction datasets via elton. For instance, you can get all qgroom's datasets using:\r\n\r\n```\r\n$ elton list --online | grep qgroom | xargs elton update\r\nupdating [qgroom/Sceliphron]... done.\r\nupdating [qgroom/Vespa-velutina]... done.\r\nupdating [qgroom/bat-co-roosting-database]... done.\r\nupdating [qgroom/batinterations]... done.\r\nupdating [qgroom/bedbugs]... done.\r\nupdating [qgroom/template-dataset]... done.\r\n$ find datasets\r\ndatasets/\r\ndatasets/qgroom\r\ndatasets/qgroom/template-dataset\r\ndatasets/qgroom/template-dataset/94bc19a3b0f172f63138fdc9384bb347f110e6fae6d42613a6eba019df6268d2\r\ndatasets/qgroom/template-dataset/access.tsv\r\n...\r\n```\r\n\r\n4. generate Belgium-only GloBI products using elton4n \r\n\r\n```\r\n$ java -cp $GLOBI_HOME/elton4n/target/elton4n-0.23.3-SNAPSHOT.jar:$GLOBI_HOME/elton4n/target/lib/* org.globalbioticinteractions.elton.Elton4N -datasetDir $PWD/datasets -exportDir $PWD/export -taxonCache file://$PWD/taxonCache.tsv -taxonMap file://$PWD/taxonMap.tsv \r\n[main] INFO org.globalbioticinteractions.elton.Elton4N - Elton4N [version: 0.23.3-SNAPSHOT@05752dba3f9593cfb85f6380720cda08933f9944]\r\n[main] INFO org.globalbioticinteractions.elton.Elton4N - processing steps: []\r\n[main] INFO org.eol.globi.db.GraphServiceFactoryImpl - neo4j starting at [/home/jhpoelen/tmp/qgroom/graph.db]...\r\n[main] INFO org.eol.globi.db.GraphServiceFactoryImpl - done\r\n[main] INFO org.eol.globi.tool.IndexerDataset - found dataset namespaces: {qgroom/Sceliphron | qgroom/Vespa-velutina | qgroom/bat-co-roosting-database | qgroom/batinterations | qgroom/bedbugs | qgroom/template-dataset}\r\n[main] INFO org.eol.globi.data.DatasetImporterForRegistry - [qgroom/Sceliphron] checking status...\r\n[main] INFO org.eol.globi.data.DatasetImporterForRegistry - [qgroom/Sceliphron] is active, importing...\r\n[main] INFO org.eol.globi.data.DatasetImporterForRegistry - [qgroom/Sceliphron] imported in 1s\r\n[main] INFO org.eol.globi.data.DatasetImporterForRegistry - [qgroom/Vespa-velutina] checking status...\r\n...\r\n[main] INFO org.eol.globi.export.GraphExporterUtil - [interactions.tsv.gz] generating... \r\n[main] INFO org.eol.globi.export.GraphExporterUtil - [interactions.tsv.gz] generated in 2s.\r\n[main] INFO org.eol.globi.export.GraphExporterUtil - [refuted-interactions.tsv.gz] generating... \r\n[main] INFO org.eol.globi.export.GraphExporterUtil - [refuted-interactions.tsv.gz] generated in 0s.\r\n...\r\n[Thread-3] INFO org.eol.globi.db.GraphServiceFactoryImpl - neo4j stopping...\r\n[Thread-3] INFO org.eol.globi.db.GraphServiceFactoryImpl - done.\r\n```\r\n\r\n5. inspect results\r\n\r\n```\r\n$ $ find export/ | grep interactions\r\nexport/interactions.nq.gz\r\nexport/csv/refuted-interactions.csv.gz\r\nexport/csv/interactions.csv.gz\r\nexport/tsv/refuted-interactions.tsv.gz\r\nexport/tsv/interactions.tsv.gz\r\n$ cat export/tsv/interactions.tsv.gz | gunzip | head -n10\r\n\r\n```\r\n\r\nNote that running steps above is not straight forward now, and meant to be a sketch of the workflow. Working on making this a little easier. \r\n\r\nIn sort, the idea is: \r\n\r\n1. generate the taxon graph you'd like to use \r\n2. select interaction datasets you'd like to use (some, or all)\r\n3. use elton4n to generate GloBI products like interactions.tsv.gz \r\n\r\ncurious to hear your thoughts on this preliminary workflow and hoping to simply for general use later . . . \r\n\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1019006421/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1019108732","html_url":"https://github.com/globalbioticinteractions/nomer/issues/73#issuecomment-1019108732","issue_url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/73","id":1019108732,"node_id":"IC_kwDOBvmSqc48vl18","user":{"login":"qgroom","id":5530576,"node_id":"MDQ6VXNlcjU1MzA1NzY=","avatar_url":"https://avatars.githubusercontent.com/u/5530576?v=4","gravatar_id":"","url":"https://api.github.com/users/qgroom","html_url":"https://github.com/qgroom","followers_url":"https://api.github.com/users/qgroom/followers","following_url":"https://api.github.com/users/qgroom/following{/other_user}","gists_url":"https://api.github.com/users/qgroom/gists{/gist_id}","starred_url":"https://api.github.com/users/qgroom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qgroom/subscriptions","organizations_url":"https://api.github.com/users/qgroom/orgs","repos_url":"https://api.github.com/users/qgroom/repos","events_url":"https://api.github.com/users/qgroom/events{/privacy}","received_events_url":"https://api.github.com/users/qgroom/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-22T08:46:19Z","updated_at":"2022-01-22T08:46:19Z","body":"You beat me to it. If I get a chance I'll try to run through your recipe and see how far I get.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1019108732/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1019142119","html_url":"https://github.com/globalbioticinteractions/nomer/issues/73#issuecomment-1019142119","issue_url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/73","id":1019142119,"node_id":"IC_kwDOBvmSqc48vt_n","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-22T09:52:48Z","updated_at":"2022-01-22T09:52:48Z","body":"@qgroom recipe is still in pre-alpha, especially the elton4n part. Hoping to streamline the process soon. Thanks for being patient.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1019142119/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1019258016","html_url":"https://github.com/globalbioticinteractions/nomer/issues/73#issuecomment-1019258016","issue_url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/73","id":1019258016,"node_id":"IC_kwDOBvmSqc48wKSg","user":{"login":"qgroom","id":5530576,"node_id":"MDQ6VXNlcjU1MzA1NzY=","avatar_url":"https://avatars.githubusercontent.com/u/5530576?v=4","gravatar_id":"","url":"https://api.github.com/users/qgroom","html_url":"https://github.com/qgroom","followers_url":"https://api.github.com/users/qgroom/followers","following_url":"https://api.github.com/users/qgroom/following{/other_user}","gists_url":"https://api.github.com/users/qgroom/gists{/gist_id}","starred_url":"https://api.github.com/users/qgroom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qgroom/subscriptions","organizations_url":"https://api.github.com/users/qgroom/orgs","repos_url":"https://api.github.com/users/qgroom/repos","events_url":"https://api.github.com/users/qgroom/events{/privacy}","received_events_url":"https://api.github.com/users/qgroom/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-22T13:15:38Z","updated_at":"2022-01-22T13:15:38Z","body":"Ok, I'll wait a bit","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1019258016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]