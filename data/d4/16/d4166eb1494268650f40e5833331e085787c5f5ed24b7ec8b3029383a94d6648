[{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1266034594","html_url":"https://github.com/globalbioticinteractions/nomer/issues/112#issuecomment-1266034594","issue_url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/112","id":1266034594,"node_id":"IC_kwDOBvmSqc5Ldiei","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-03T20:53:50Z","updated_at":"2022-10-03T20:53:50Z","body":"@jtmiller28 thanks for pointing out that the authorship strings are not being preserved on name parsing using @dimus 's Global Names parser and @mdoering 's GBIF name parser. \r\n\r\nI made a first pass at preserving the authorship strings as formatted by the name parsers. \r\n\r\nusing ```my.properties```\r\n\r\n```\r\nnomer.append.schema.output.example.taxon.rank.order=[{\"column\":0,\"type\":\"path.order.id\"},{\"column\": 1,\"type\":\"path.order.name\"},{\"column\": 2,\"type\":\"path.order\"}]\r\nnomer.append.schema.output=[{\"column\":0,\"type\":\"externalId\"},{\"column\": 1,\"type\":\"name\"},{\"column\": 2,\"type\":\"authorship\"},{\"column\":3,\"type\":\"rank\"}]\r\nnomer.schema.input=[{\"column\":0,\"type\":\"externalId\"},{\"column\": 1,\"type\":\"name\"},{\"column\": 2,\"type\":\"authorship\"},{\"column\": 3, \"type\":\"rank\"}]\r\n```\r\n\r\nI was able to produce:\r\n\r\n```\r\n$ echo -e \"\\tHomo sapiens Linneaus 1758\" | nomer append gbif-parse --include-header --properties my.properties \r\n[main] INFO org.globalbioticinteractions.nomer.match.TermMatcherRegistry - using matcher [gbif-parse]\r\nprovidedExternalId\tprovidedName\trelationName\tresolvedExternalId\tresolvedName\tresolvedAuthorship\tresolvedRank\r\n\tHomo sapiens Linneaus 1758\tSAME_AS\t\tHomo sapiens\tLinneaus, 1758\t\r\n```\r\n\r\nand \r\n\r\n```\r\n$ echo -e \"\\tHomo sapiens Linneaus 1758\" | nomer append gn-parse --include-header --properties my.properties \r\n[main] INFO org.globalbioticinteractions.nomer.match.TermMatcherRegistry - using matcher [gn-parse]\r\nprovidedExternalId\tprovidedName\trelationName\tresolvedExternalId\tresolvedName\tresolvedAuthorship\tresolvedRank\r\n\tHomo sapiens Linneaus 1758\tSAME_AS\t\tHomo sapiens\tLinneaus 1758\t\r\n```\r\n\r\nnote that GBIF parser adds a comma between name and year, whereas GN parser leaves does not insert the comma. \r\n\r\nHoping to include this functionality in upcoming nomer release. ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1266034594/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1266045327","html_url":"https://github.com/globalbioticinteractions/nomer/issues/112#issuecomment-1266045327","issue_url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/112","id":1266045327,"node_id":"IC_kwDOBvmSqc5LdlGP","user":{"login":"jtmiller28","id":82229873,"node_id":"MDQ6VXNlcjgyMjI5ODcz","avatar_url":"https://avatars.githubusercontent.com/u/82229873?v=4","gravatar_id":"","url":"https://api.github.com/users/jtmiller28","html_url":"https://github.com/jtmiller28","followers_url":"https://api.github.com/users/jtmiller28/followers","following_url":"https://api.github.com/users/jtmiller28/following{/other_user}","gists_url":"https://api.github.com/users/jtmiller28/gists{/gist_id}","starred_url":"https://api.github.com/users/jtmiller28/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtmiller28/subscriptions","organizations_url":"https://api.github.com/users/jtmiller28/orgs","repos_url":"https://api.github.com/users/jtmiller28/repos","events_url":"https://api.github.com/users/jtmiller28/events{/privacy}","received_events_url":"https://api.github.com/users/jtmiller28/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-03T21:02:34Z","updated_at":"2022-10-03T21:02:34Z","body":"Thanks jorrit! I'll add this to my workflow and provide feedback once name resolution occurs. ","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1266045327/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1266055777","html_url":"https://github.com/globalbioticinteractions/nomer/issues/112#issuecomment-1266055777","issue_url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/112","id":1266055777,"node_id":"IC_kwDOBvmSqc5Ldnph","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-03T21:13:30Z","updated_at":"2022-10-03T21:13:30Z","body":"https://github.com/globalbioticinteractions/nomer/releases/tag/0.3.1 is now available with fix for this issue. @jtmiller28 please review.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1266055777/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1268756113","html_url":"https://github.com/globalbioticinteractions/nomer/issues/112#issuecomment-1268756113","issue_url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/112","id":1268756113,"node_id":"IC_kwDOBvmSqc5Ln66R","user":{"login":"jtmiller28","id":82229873,"node_id":"MDQ6VXNlcjgyMjI5ODcz","avatar_url":"https://avatars.githubusercontent.com/u/82229873?v=4","gravatar_id":"","url":"https://api.github.com/users/jtmiller28","html_url":"https://github.com/jtmiller28","followers_url":"https://api.github.com/users/jtmiller28/followers","following_url":"https://api.github.com/users/jtmiller28/following{/other_user}","gists_url":"https://api.github.com/users/jtmiller28/gists{/gist_id}","starred_url":"https://api.github.com/users/jtmiller28/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtmiller28/subscriptions","organizations_url":"https://api.github.com/users/jtmiller28/orgs","repos_url":"https://api.github.com/users/jtmiller28/repos","events_url":"https://api.github.com/users/jtmiller28/events{/privacy}","received_events_url":"https://api.github.com/users/jtmiller28/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-05T17:56:37Z","updated_at":"2022-10-05T17:56:37Z","body":"Hey jorrit, this is a great addition to nomer for keeping track of intended authorship. I've tried it out and it works as intended. \r\n\r\n`echo -e \"\\tHelianthemum scoparium\\tNutt. ex Torr. & A.Gray\" | nomer append wfo --include-header --properties file://$PWD/my.properties2`\r\nprovidedExternalId\tprovidedName\tprovidedAuthorship\trelationName\tresolvedExternalId\tresolvedName\tresolvedAuthorship\tresolvedRank\r\n[main] INFO org.globalbioticinteractions.nomer.match.WorldOfFloraOnlineTaxonService - [WORLD_OF_FLORA_ONLINE] taxonomy already indexed at [/home/jt-miller/.cache/nomer/world_of_flora_online/world_of_flora_online], no need to import.\r\n\tHelianthemum scoparium\tNutt. ex Torr. & A.Gray\tHAS_ACCEPTED_NAME\tWFO:0001295598\tHelianthemum scoparium\tNutt. ex Torr. & A.Gray\tspecies\r\n\r\nThere is a bit of a problem when including authorship on real world data however, in that it seems pretty common that authors are not correctly written as per the exact character string that the catalogue has listed. This is probably due to more ambiguity in how an author should be correctly notated for example:  abbreviation, order of names listed, etc. \r\n\r\nThe result of this is most mappings will end up listed as NONE just due to the author field being filled out, but there being a case of at least one character mismatch in the author string. A way around this workflow wise that I am planning to use is run my list through nomer just looking at scientificName > find all instances where multiple mappings are generated (indicating authorship matters for determining correct name mapping according to the catalogue) > rerun multiple mapping names only while the including of authorship. \r\n\r\nI think we can both agree that fuzzy matching is a bit pecarious so not the best solution here, but it might be interesting to enable nomer so that if it fails to match a name when authorship is provided it defaults back to just using the provided scientificName field only. As an example from my data:\r\n\r\n'echo -e \"\\tHelianthemum scoparium\\tNutt. ex Torr. & A. Gray\" | nomer append wfo --include-header --properties file://$PWD/my.properties2' \r\nreturns:\r\nHelianthemum scoparium\tNutt. ex Torr. & A. Gray\tNONE\t\tHelianthemum scoparium\tNutt. ex Torr. & A. Gray\r\n\r\nAfter looking at the WFO catalogue, it becomes apparent the only difference between the name pulled from gbif is that A. Gray should be A.Gray without the white space:\r\n\r\n`echo -e \"\\tHelianthemum scoparium\\tNutt. ex Torr. & A.Gray\" | nomer append wfo --include-header --properties file://$PWD/my.properties2`\r\nreturns:\r\nHelianthemum scoparium\tNutt. ex Torr. & A.Gray\tHAS_ACCEPTED_NAME\tWFO:0001295598\tHelianthemum scoparium\tNutt. ex Torr. & A.Gray\tspecies\r\n\r\nThis is easy to find in a simple example like above, however it becomes rather daunting when presented with tens of thousands of such erroneous mappings only due to authorship. If instead there was some field that denoted authorship matching failed so nomer retried scientificName only and was successful, this could alleviate many false NONE matches just due to ambiguity in correctly writing authorship to the catalogues exact standard. It would also provide a way to track where these authorships failed if one was interested in tracking down author names that appear erroneous in their datasets. \r\n\r\nHope that makes sense, thanks for all of your attention to this discussion about enhancement!\r\n\r\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1268756113/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1298939802","html_url":"https://github.com/globalbioticinteractions/nomer/issues/112#issuecomment-1298939802","issue_url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/112","id":1298939802,"node_id":"IC_kwDOBvmSqc5NbD-a","user":{"login":"dimus","id":12124,"node_id":"MDQ6VXNlcjEyMTI0","avatar_url":"https://avatars.githubusercontent.com/u/12124?v=4","gravatar_id":"","url":"https://api.github.com/users/dimus","html_url":"https://github.com/dimus","followers_url":"https://api.github.com/users/dimus/followers","following_url":"https://api.github.com/users/dimus/following{/other_user}","gists_url":"https://api.github.com/users/dimus/gists{/gist_id}","starred_url":"https://api.github.com/users/dimus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dimus/subscriptions","organizations_url":"https://api.github.com/users/dimus/orgs","repos_url":"https://api.github.com/users/dimus/repos","events_url":"https://api.github.com/users/dimus/events{/privacy}","received_events_url":"https://api.github.com/users/dimus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-11-01T18:29:02Z","updated_at":"2022-11-01T18:29:02Z","body":"Note that authors are sometimes abbreviated, omitted, or ordered in a different way. Because of that direct comparison of authors does not work all the time. So gnresolver uses this algorithm for matching https://github.com/gnames/gnames/blob/master/ent/score/auth.go","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1298939802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1315694604","html_url":"https://github.com/globalbioticinteractions/nomer/issues/112#issuecomment-1315694604","issue_url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/112","id":1315694604,"node_id":"IC_kwDOBvmSqc5Oa-gM","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-11-15T18:14:39Z","updated_at":"2022-11-15T18:15:00Z","body":"note that v0.4.1 of Nomer now includes authorship in the default input/output schema \r\n\r\n```\r\necho -e \"\\tHelianthemum scoparium\\tNutt. ex Torr. & A.Gray\" | nomer append col --include-header\r\n```\r\n\r\n| providedExternalId | providedName | providedAuthorship | relationName | resolvedExternalId | resolvedName | resolvedAuthorship | resolvedRank | resolvedCommonNames | resolvedPath | resolvedPathIds | resolvedPathNames | resolvedPathAuthorships | resolvedExternalUrl |\r\n| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |\r\n|  | Helianthemum scoparium | Nutt. ex Torr. & A.Gray | NONE |  | Helianthemum scoparium | Nutt. ex Torr. & A.Gray |  |  |  |  |  |  |  |\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1315694604/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1315703352","html_url":"https://github.com/globalbioticinteractions/nomer/issues/112#issuecomment-1315703352","issue_url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/112","id":1315703352,"node_id":"IC_kwDOBvmSqc5ObAo4","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-11-15T18:23:27Z","updated_at":"2022-11-15T18:23:27Z","body":"And with WFO\r\n\r\n```\r\necho -e \"\\tHelianthemum scoparium\\tNutt. ex Torr. & A.Gray\" |  nomer append wfo --include-header \r\n```\r\n\r\n\r\n| providedExternalId | providedName | providedAuthorship | relationName | resolvedExternalId | resolvedName | resolvedAuthorship | resolvedRank | resolvedCommonNames | resolvedPath | resolvedPathIds | resolvedPathNames | resolvedPathAuthorships | resolvedExternalUrl |\r\n| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |\r\n|  | Helianthemum scoparium | Nutt. ex Torr. & A.Gray | HAS_ACCEPTED_NAME | WFO:0001295598 | Helianthemum scoparium | Nutt. ex Torr. & A.Gray | species |  | Angiosperms \\| Malvales \\| Cistaceae \\| Helianthemum \\| Helianthemum scoparium | WFO:9949999999 \\| WFO:9000000312 \\| WFO:7000000136 \\| WFO:4000017201 \\| WFO:0001295598 | phylum \\| order \\| family \\| genus \\| species |  | http://www.worldfloraonline.org/taxon/wfo-0001295598 |\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/globalbioticinteractions/nomer/issues/comments/1315703352/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]